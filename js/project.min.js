var checkArkDataset,checkProjectAuthorization,copyLink,postAuthorizeRender,publicData,renderEmail,renderMapWithData,renderPublicMap,searchProjects,setPublicData,showCitation,showEmailField,sqlQueryBox,indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};_adp.mapRendered=!1,_adp.zcClient=null,publicData=null,checkProjectAuthorization=function(a,b){return null==a&&(a=_adp.projectId),null==b&&(b=postAuthorizeRender),startLoad(),console.info("Checking authorization for "+a),checkLoggedIn(function(c){var d,e,f;return null==a?(c.status?(console.info("Logged in user, no project"),d='<paper-icon-button icon="icons:dashboard" class="authorized-action" id="show-actions" data-href="'+uri.urlString+'admin-page.html" data-toggle="tooltip" title="Administration Dashboard"> </paper-icon-button>'):console.info("Not logged in"),stopLoad(),!1):c.status?(f=uri.urlString+"admin-api.php",e="perform=check_access&project="+a,$.post(f,e,"json").done(function(a){var c;return a.status?(console.info("User is authorized"),c=a.detail.project,"function"==typeof b?b(c,a.detailed_authorization):(console.warn("No callback specified!"),console.info("Got project data",c))):console.info("User is unauthorized")}).fail(function(a,b){return console.log("Error checking server",a,b)}).always(function(){return stopLoad()})):(console.info("Non logged-in user or unauthorized user"),renderPublicMap(),stopLoad(),!1)}),!1},renderEmail=function(a){var b,c;return animateLoad(),c=uri.urlString+"api.php",b="action=is_human&recaptcha_response="+a+"&project="+_adp.projectId,$.post(c,b,"json").done(function(a){var b;return console.info("Checked response"),console.log(a),b=a.author_data,showEmailField(b.contact_email),stopLoad()}).fail(function(a,b){return stopLoadError("Sorry, there was a problem getting the contact email"),!1}),!1},showEmailField=function(a){var b;return b='<div class="row">\n  <paper-input readonly class="col-xs-8 col-md-11" label="Contact Email" value="'+a+'"></paper-input>\n  <paper-fab icon="communication:email" class="click materialblue" id="contact-email-send" data-href="mailto:'+a+'" data-toggle="tooltip" title="Send Email"></paper-fab>\n</div>',$("#email-fill").replaceWith(b),bindClicks("#contact-email-send"),!1},renderMapWithData=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(null==b&&(b=!1),_adp.mapRendered===!0&&b!==!0)return console.warn("The map was asked to be rendered again, but it has already been rendered!"),!1;if(i=JSON.parse(deEscape(a.carto_id)),_adp.cartoDataParsed=i,A=i.raw_data,A.hasDataFile&&(p="helpers/",o=A.filePath,-1===o.search(p)&&(o=""+p+o),m="",g=a.dataset_arks.split(","),g.length>0))for(h=o.split("/"),h.pop(),h=h.join("/"),r=0,s=0,u=g.length;u>s;s++)e=g[s],l=e.split("::"),f=l[0],o=h+"/"+l[1],n=0===r?"":"btn-xs download-alt-datafile",D=0===r?"Download Newest Datafile":f+" dataset",q='<button class="btn btn-primary click download-file download-data-file '+n+'" data-href="'+o+'" data-newtab="true" data-toggle="tooltip" title="'+f+' (right-click to copy)" data-ark="'+f+'">\n  <iron-icon icon="editor:insert-chart"></iron-icon>\n  '+D+"\n</button>",m+=q,++r;null==m&&(m=""),k=i.table;try{H=null!=(B=i.bounding_polygon.paths)?B:i.bounding_polygon,G=getMapZoom(H,"#transect-viewport"),console.info("Got zoom",G)}catch(I){G=""}for(z=i.bounding_polygon,(isArray(z)||null==(null!=z?z.paths:void 0))&&(x=z,E=toObject(z),"object"!=typeof E&&(E={}),E.paths=z,isArray(E.paths)||(E.paths=[]),z=E),null==z.fillColor&&(z.fillColor=defaultFillColor),null==z.fillOpacity&&(z.fillOpacity=defaultFillOpacity),w='<google-map-poly closed fill-color="'+z.fillColor+'" fill-opacity="'+z.fillOpacity+'" stroke-weight="1">',F=[],C=z.paths,t=0,v=C.length;v>t;t++)y=C[t],indexOf.call(F,y)<0&&(F.push(y),w+='<google-map-point latitude="'+y.lat+'" longitude="'+y.lng+'"> </google-map-point>');return w+="    </google-map-poly>",j="SELECT genus, specificepithet, diseasetested, diseasedetected, originaltaxa, ST_asGeoJSON(the_geom) FROM "+k+";",console.info("Would ping cartodb with",j),c=encodeURIComponent(encode64(j)),d="action=fetch&sql_query="+c,$.post("api.php",d,"json").done(function(b){var c,d,f,g,h,i,j,k,l,n,o,p,s,t,u,v,x,y,A,B,C,D,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y;if(_adp.mapRendered===!0)return console.warn("Duplicate map render! Skipping thread"),!1;if(console.info("Carto query got result:",b),!b.status)return j=null!=(O=b.human_error)?O:b.error,null==j&&(j="Unknown error"),stopLoadError("Sorry, we couldn't retrieve your information at the moment ("+j+")"),!1;S=b.parsed_responses[0].rows,M=[],L=[],console.log("Running swapped cartoDB order (lng, lat)"),K={};for(o in S){R=S[o],k=JSON.parse(R.st_asgeojson),p=k.coordinates[1],x=k.coordinates[0],M.push([p,x]);try{L.push(canonicalizePoint([p,x]))}catch(Z){}V=R.genus+" "+R.specificepithet,null==K[V]&&(K[V]={positive:!1,negative:!1,no_confidence:!1,counts:{total:0,positive:0,negative:0,no_confidence:0}}),R.diseasedetected=function(){switch((""+R.diseasedetected).toLowerCase()){case"true":return K[V].positive=!0,K[V].counts.positive++,"positive";case"false":return K[V].negative=!0,K[V].counts.negative++,"negative";default:return K[V].no_confidence=!0,K[V].counts.no_confidence++,""+R.diseasedetected}}(),K[V].counts.total++,H="",V!==R.originaltaxa&&(H="(<em>"+R.originaltaxa+"</em>)"),B='<google-map-marker latitude="'+p+'" longitude="'+x+'" data-disease-detected="'+R.diseasedetected+'">\n  <p>\n    <em>'+R.genus+" "+R.specificepithet+"</em> "+H+"\n    <br/>\n    Tested <strong>"+R.diseasedetected+"</strong> for "+R.diseasetested+"\n  </p>\n</google-map-marker>","positive"!==R.diseasedetected&&"negative"!==R.diseasedetected&&(R.diseasedetected="inconclusive"),$(".aweb-link-species[data-species='"+R.genus+" "+R.specificepithet+"']").attr("data-"+R.diseasedetected,"true"),w+=B}if(null==(null!=z?z.paths:void 0))try{_adp.canonicalHull=createConvexHull(M,!0)}catch(Z){}for(l='<google-map id="transect-viewport" latitude="'+a.lat+'" longitude="'+a.lng+'" map-type="hybrid" disable-default-ui zoom="'+G+'" class="col-xs-12 col-md-9 col-lg-6">\n  '+w+"\n</google-map>",D="",F=a.sampling_months.split(","),r=0,y=0,s=F.length;s>y;y++)C=F[y],++r,r>1&&r===F.length?(F.length>2&&(D+=","),D+=" and "):r>1&&(D+=", "),isNumber(C)&&(C=dateMonthToString(C)),D+=C;for(r=0,X="",Y=a.sampling_years.split(","),r=0,I=0,t=Y.length;t>I;I++)W=Y[I],++r,r>1&&r===Y.length?(Y.length>2&&(X+=","),X+=" and "):r>1&&(X+=", "),X+=W;if(X=1===Y.length?"the year "+X:"the years "+X,g=new Date(toInt(a.sampled_collection_start)),h=new Date(toInt(a.sampled_collection_end)),d=dateMonthToString(g.getMonth())+" "+g.getFullYear()+" &#8212; "+dateMonthToString(h.getMonth())+" "+h.getFullYear(),A='<div class="row">\n  <h2 class="col-xs-12">Mapping Data</h2>\n  '+l+'\n  <div class="col-xs-12 col-md-3 col-lg-6">\n    <p class="text-muted"><span class="glyphicon glyphicon-calendar"></span> Data were taken from '+d+'</p>\n    <p class="text-muted"><span class="glyphicon glyphicon-calendar"></span> Data were taken in '+D+'</p>\n    <p class="text-muted"><span class="glyphicon glyphicon-calendar"></span> Data were sampled in '+X+'</p>\n    <p class="text-muted"><iron-icon icon="icons:language"></iron-icon> The effective project center is at ('+roundNumberSigfig(a.lat,6)+", "+roundNumberSigfig(a.lng,6)+") with a sample radius of "+a.radius+"m and a resulting locality <strong class='locality'>"+a.locality+'</strong></p>\n    <p class="text-muted"><iron-icon icon="editor:insert-chart"></iron-icon> The dataset contains '+a.disease_positive+" positive samples ("+roundNumber(100*a.disease_positive/a.disease_samples)+"%), "+a.disease_negative+" negative samples ("+roundNumber(100*a.disease_negative/a.disease_samples)+"%), and "+a.disease_no_confidence+" inconclusive samples ("+roundNumber(100*a.disease_no_confidence/a.disease_samples)+'%)</p>\n    <div class="download-buttons" id="data-download-buttons">\n      '+m+"\n    </div>\n  </div>\n</div>",A=A.replace(/NaN/gm,"0"),_adp.mapRendered!==!0&&($("#auth-block").append(A),setupMapMarkerToggles(),_adp.mapRendered=!0,!isNull(_adp.pageSpeciesList))){for(console.log("Creating CSV downloader for species list"),f=new Date,J={create:!0,downloadFile:"species-list-"+a.project_id+"-"+f.toISOString()+".csv",selector:".download-buttons",buttonText:"Download Species List",splitValues:" ",header:["Genus","Species","Subspecies","Positive Samples?","Negative Samples?","Inconclusive Samples?","Positive Count","Negative Count","Inconclusive Count","Totals"]},c=[],P=_adp.pageSpeciesList,N=0,u=P.length;u>N;N++){if(T=P[N],E=T.split(J.splitValues),E.length<3)for(;E.length<3;)E.push("");null!=K[T]?(E.push(""+K[T].positive),E.push(""+K[T].negative),E.push(""+K[T].no_confidence),E.push(""+K[T].counts.positive),E.push(""+K[T].counts.negative),E.push(""+K[T].counts.no_confidence),E.push(""+K[T].counts.total)):(console.warn("CSV downloader couldn't find "+T+" in perTaxaStatus"),window.perTaxaStatus=K),c.push(E.join(J.splitValues))}downloadCSVFile(c,J)}for(bindClicks(".download-file"),sqlQueryBox(),$(".download-data-file").contextmenu(function(a){var b,c,d,f,g,h,i,j;return a.preventDefault(),console.log("Event details",a),f=$(this).offset(),q='<paper-material class="ark-context-wrapper" style="top:'+a.pageY+"px;left:"+a.pageX+'px;position:absolute">\n  <paper-menu class=context-menu">\n    <paper-item class="copy-ark-context">\n      Copy ARK to clipboard\n    </paper-item>\n  </paper-menu>\n</paper-material>',$(".ark-context-wrapper").remove(),$("body").append(q),getMapZoom(L,"#transect-viewport"),ZeroClipboard.config(_adp.zcConfig),j=new ZeroClipboard($(".copy-ark-context").get(0)),e=$(this).attr("data-ark"),i="http://biscicol.org/id/"+e,c={dataType:"text/plain",data:i,"text/plain":i},j.setData(c),j.on("aftercopy",function(a){return a.data["text/plain"]?toastStatusMessage("ARK resolver path copied to clipboard"):(console.error("ZeroClipboard had an error - ",a),console.warn(c),toastStatusMessage("Error copying to clipboard"))}),j.on("error",function(a){var b;return console.error("Initial error"),b=new ZeroClipboard($(".copy-ark-context").get(0)),d(b)}),d=function(a,b){var e,f,g;null==a&&(a=j),null==b&&(b=null);try{return e=new ClipboardEvent("copy",c),document.dispatchEvent(e),toastStatusMessage("ARK resolver path copied to clipboard"),!1}catch(g){f=g,console.error("Error creating copy: "+f.message),console.warn(f.stack),console.warn("Can't use HTML5")}return a.setData(c),isNull(b)||b.setData(c),a.on("aftercopy",function(a){return a.data["text/plain"]?toastStatusMessage("ARK resolver path copied to clipboard"):(console.error("ZeroClipboard had an error - ",a),console.warn(c),toastStatusMessage("Error copying to clipboard"))}),a.on("error",function(b){if(console.error("Error copying to clipboard"),console.warn("Got",b),"flash-overdue"===b.name){if(_adp.resetClipboard===!0)return console.error("Resetting ZeroClipboard didn't work!"),!1;ZeroClipboard.on("ready",function(){return _adp.resetClipboard=!0,a=new ZeroClipboard($(".copy-ark-context").get(0)),d(a)})}return"flash-disabled"===b.name?(console.info("No flash on this system"),ZeroClipboard.destroy(),toastStatusMessage("Clipboard copying isn't available on your system")):Z})},g=function(a){return $(this).addClass("iron-selected"),!1},h=function(a){return $(this).removeClass("iron-selected"),!1},b=this,$(".ark-context-wrapper paper-item").hover(g,h).click(function(){return _adp.resetClipboard=!1,$(".ark-context-wrapper").remove(),!1}).contextmenu(function(){return $(".ark-context-wrapper").remove(),!1}),!1}),checkArkDataset(a),setPublicData(a),Q=$(".aweb-link-species"),U=0,v=Q.length;v>U;U++)i=Q[U],n=$(i).attr("data-positive").toBool(),n&&$(i).attr("data-negative","false").attr("data-inconclusive","false");return stopLoad()}).fail(function(a,b){return console.error(a,b),stopLoadError("Couldn't render map")}),!1},postAuthorizeRender=function(a,b){var c,d,e,f;return a["public"]&&console.info("Project is already public, not rerendering"),startLoad(),console.info("Should render stuff",a),f=c="",b.can_edit&&(f='<paper-icon-button icon="icons:create" class="authorized-action" data-href="'+uri.urlString+"admin-page.html?id="+a.project_id+'" data-toggle="tooltip" title="Edit Project"></paper-icon-button>'),c='<paper-icon-button icon="icons:dashboard" class="authorized-action" id="show-actions" data-href="'+uri.urlString+'admin-page.html" data-toggle="tooltip" title="Administration Dashboard"> </paper-icon-button>',$("#title").append(f),d=JSON.parse(a.author_data),showEmailField(d.contact_email),bindClicks(".authorized-action"),e=JSON.parse(deEscape(a.carto_id)),renderMapWithData(a),!1},copyLink=function(a,b,c){var d,e,f,g,h,i;if(null==a&&(a=_adp.zcClient),null==c&&(c=!0),d=p$(".ark-identifier").value,c)try{return i="http://biscicol.org/id/"+d,f={dataType:"text/plain",data:i,"text/plain":i},e=new ClipboardEvent("copy",f),document.dispatchEvent(e),toastStatusMessage("ARK resolver path copied to clipboard"),!1}catch(h){g=h,console.error("Error creating copy: "+g.message),console.warn(g.stack)}return console.warn("Can't use HTML5"),null!=a?(a.setData(f),null!=b&&b.setData(f),a.on("aftercopy",function(a){return a.data["text/plain"]?toastStatusMessage("ARK resolver path copied to clipboard"):toastStatusMessage("Error copying to clipboard")}),a.on("error",function(a){if(console.error("Error copying to clipboard"),console.warn("Got",a),"flash-overdue"===a.name){if(_adp.resetClipboard===!0)return console.error("Resetting ZeroClipboard didn't work!"),!1;ZeroClipboard.on("ready",function(){return _adp.resetClipboard=!0,copyLink()}),_adp.zcClient=new ZeroClipboard($("#copy-ark").get(0))}return"flash-disabled"===a.name?(console.info("No flash on this system"),ZeroClipboard.destroy(),$("#copy-ark").tooltip("destroy").remove(),$(".ark-identifier").removeClass("col-xs-9 col-md-11").addClass("col-xs-12"),toastStatusMessage("Clipboard copying isn't available on your system")):void 0})):console.error("Can't use HTML, and ZeroClipboard wasn't passed"),!1},searchProjects=function(){var a,b,c,d;return d=$("#project-search").val(),isNull(d)?($("google-map-poly").removeAttr("hidden"),!1):(c=p$("#search-filter").selectedItem,b=$(c).attr("data-cols"),console.info("Searching on "+d+" ... in "+b),a="action=search_project&q="+d+"&cols="+b,$.post(uri.urlString+"api.php",a,"json").done(function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q;if(console.info(a),c="",q=[],l=Object.toArray(a.result),l.length>0)for(f=0,h=l.length;h>f;f++)j=l[f],q.push(j.project_id),m=j["public"].toBool(),e=m?'<iron-icon icon="social:public"></iron-icon>':'<iron-icon icon="icons:lock"></iron-icon>',b='<button class="btn btn-info search-proj-link" data-href="'+uri.urlString+"project.php?id="+j.project_id+'" data-toggle="tooltip" data-placement="right" title="Project #'+j.project_id.slice(0,8)+'...">\n  '+e+" "+j.project_title+"\n</button>",c+="<li class='project-search-result'>"+b+"</li>";else p=null!=(n=a.search)?n:d,c='<p><em>No results found for "<strong>'+p+'</strong>"';for($("#project-result-container").html(c),bindClicks(".search-proj-link"),$("google-map-poly").attr("hidden","hidden"),o=[],g=0,i=q.length;i>g;g++)k=q[g],o.push($("google-map-poly[data-project='"+k+"']").removeAttr("hidden"));return o}).fail(function(a,b){return console.error(a,b)}),!1)},setPublicData=function(a){return publicData=a,!1},renderPublicMap=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;null==a&&(a=publicData);try{if(a["public"].toBool())return console.info("Not rendering low-data public map for public project"),!1}catch(u){return console.error("Invalid project data passed!"),console.warn(a),!1}try{console.info("Working with limited data",a),b=a.carto_id,p=b.bounding_polygon,null==p.fillColor&&(p.fillColor="#ff7800"),null==p.fillOpacity&&(p.fillOpacity=.35),k='<google-map-poly closed fill-color="'+p.fillColor+'" fill-opacity="'+p.fillOpacity+'" stroke-weight="1">',s=[],m={lat:a.bounding_box_n,lng:a.bounding_box_w},l={lat:a.bounding_box_n,lng:a.bounding_box_e},q={lat:a.bounding_box_s,lng:a.bounding_box_e},r={lat:a.bounding_box_s,lng:a.bounding_box_w},n=[m,l,q,r],c=getPointsFromBoundingBox(a);try{t=getMapZoom(c,"#transect-viewport"),console.info("Got public zoom",t)}catch(v){t=""}for(i=0,j=n.length;j>i;i++)o=n[i],indexOf.call(s,o)<0&&(s.push(o),k+='<google-map-point latitude="'+o.lat+'" longitude="'+o.lng+'"> </google-map-point>');k+="    </google-map-poly>",h='<div class="row" id="public-map">\n  <h2 class="col-xs-12">Project Area of Interest</h2>\n  <google-map id="transect-viewport" latitude="'+a.lat+'" longitude="'+a.lng+'" map-type="hybrid" disable-default-ui zoom="'+t+'" class="col-xs-12 col-md-9 col-lg-6 center-block clearfix public-fuzzy-map"  apiKey="'+gMapsApiKey+'">\n        '+k+"\n  </google-map>\n</div>",$("#auth-block").append(h);try{return t=getMapZoom(n,"#transect-viewport"),p$("#transect-viewport").zoom=t}catch(f){e=f;try{return t=getMapZoom(c,"#transect-viewport"),p$("#transect-viewport").zoom=t}catch(w){}}}catch(g){return d=g,stopLoadError("Couldn't render map"),console.error("Map rendering error - "+d.message),console.warn(d.stack)}},checkArkDataset=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(null==b&&(b=!1),null==c&&(c=!1),"undefined"!=typeof _adp&&null!==_adp||(window._adp={}),l=uri.o.attr("fragment"),k=l.split(","),c||null==_adp.fragmentData){for(console.info("Examining fragment list"),h={},m=0,o=k.length;o>m;m++)d=k[m],s=d.split(":"),h[s[0]]=s[1];_adp.fragmentData=h}if(j=null!=(t=_adp.fragmentData)?t.dataset:void 0,null==j)return!1;for(console.info("Checking  ARK identifiers for dataset "+j+" ..."),f=a.dataset_arks.split(","),g="",q=!1,n=0,p=f.length;p>n;n++)if(e=f[n],-1!==e.search(j)){g=e,q=!0;break}return q!==!0?(console.warn("Could not find matching dataset in",f),!1):(h=g.split("::"),i=h[1],console.info("Got matching identifier "+g+" -> "+i),u=".download-file[data-href*='"+i+"']",u=$(u).get(0),b?(v=$(u).attr("data-href"),openTab(v)):($(u).removeClass("btn-xs btn-primary").addClass("btn-success success-glow").click(function(){return $(this).removeClass("success-glow")}),r={behavior:"smooth",block:"start"},$(u).get(0).scrollIntoView(!1)),u)},sqlQueryBox=function(){var a,b,c,d,e;return null==_adp.cartoDataParsed?(console.error("CartoDB data not available. Are you logged in?"),!1):(c=function(a){var b;return console.info("Querying with"),console.log(a),b="action=fetch&sql_query="+post64(a),_adp.currentAsyncJqxhr=$.post("api.php",b,"json").done(function(a){var b,c,d,e,f,g,h,i,j,k,l;if(console.log(a),a.status!==!0)return c=null!=(i=null!=(j=a.human_error)?j:a.error)?i:"Unknown error",console.error(error),$("#query-immediate-result").text(error),!1;try{h=JSON.parse(a.post_response[0])}catch(d){b=d,console.error("Error parsing result")}if(null!=h.error)return console.error("Error in result: "+h.error),$("#query-immediate-result").text(h.error),!1;console.log("Using responses",a.parsed_responses),g="",k=a.parsed_responses;for(e in k){l=k[e],f=e+1,g+="#"+f+": ";try{g+=JSON.stringify(l.rows)}catch(m){g+="BAD QUERY"}g+="\n\n"}return $("#query-immediate-result").text(g),!1}),!1},a=function(a){var b,c;return b=a,c=b.replace(/@@/gim,_adp.cartoDataParsed.table),c=c.replace(/!@/gim,"SELECT * FROM "+_adp.cartoDataParsed.table),$("#query-input").val(c),c},d=function(){return!1},e=function(){return!1},$("#project-sql-query-box").exists()||(b='<div id="project-sql-query-box" class="row">\n  <h2 class="col-xs-12">Raw Project Queries</h2>\n  <textarea class="form-control code col-xs-12" rows="3" id="query-input" placeholder="SQL Query" aria-describedby="query-cheats"></textarea>\n  <div class="col-xs-12 clearfix">\n    <span class="text-muted" id="query-cheats">Tips: <ol><li>You\'re querying PostgreSQL</li><li>Type <kbd>@@</kbd> as a placeholder for the table name</li><li>Type <kbd>!@</kbd> as a placeholder for <code>SELECT * FROM @@</code></li><li>Multiple queries at once is just fine. They\'re broken at <kbd>);</kbd>, so enclosing your <code>WHERE</code> in parentheses is good enough.</li></ol></span>\n    <button class="btn btn-default do-sql-query pull-right">Execute Query</button>\n  </div>\n  <pre class="code col-xs-12" id="query-immediate-result"></pre>\n</div>',$("main").append(b)),$(".do-sql-query").click(function(){var b,d;return console.info("Executing query ..."),b=$("#query-input").val(),d=a(b),c(d)}),!1)},showCitation=function(){var a;return a=p$("paper-input[label='DOI']").value,$("#citation-pop").exists()?p$("#citation-pop").open():(animateLoad(),fetchCitation(a,function(a,b){var c,d;d=isNull(b)?"":'<paper-button class="click" data-newtab="true" data-href="'+b+'">\n  <iron-icon icon="icons:open-in-new"></iron-icon>\n  Open\n</paper-button>',c='<paper-dialog id="citation-pop" modal>\n  <h2>Citation</h2>\n  <paper-dialog-scrollable>\n    <div class="pop-contents">\n      <paper-textarea label="Citation" id="popped-citation" readonly>\n        '+a+'\n      </paper-textarea>\n    </div>\n  </paper-dialog-scrollable>\n  <div class="buttons">\n    <paper-button id="copy-citation" class="click-copy" data-copy-selector="#popped-citation">\n      <iron-icon icon="icons:content-copy"></iron-icon>\n      Copy Citation\n    </paper-button>\n    <paper-button id="copy-doi" class="click-copy" data-copy-selector="#doi-input">\n      <iron-icon icon="icons:content-copy"></iron-icon>\n      Copy DOI\n    </paper-button>\n    '+d+"\n    <paper-button dialog-dismiss>Close</paper-button>\n  </div>\n</paper-dialog>",$("body").append(c);try{p$("#popped-citation").value=a}catch(e){delay(500,function(){try{return p$("#popped-citation").value=a}catch(b){}})}return bindClicks(),bindCopyEvents(),safariDialogHelper("#citation-pop"),stopLoad()})),!1},window.showCitation=showCitation,$(function(){var a;return _adp.projectId=uri.o.param("id"),checkProjectAuthorization(),$("#project-list button").unbind().click(function(){var a;return a=$(this).attr("data-project"),goTo(uri.urlString+"project.php?id="+a)}),$("#project-search").unbind().keyup(function(){return searchProjects.debounce()}),$("paper-radio-button").click(function(){var a;return a=$(this).attr("data-cue"),$("#project-search").attr("placeholder",a),searchProjects.debounce()}),a={swfPath:"bower_components/zeroclipboard/dist/ZeroClipboard.swf"},_adp.zcConfig=a,ZeroClipboard.config(a),_adp.zcClient=new ZeroClipboard($("#copy-ark").get(0)),$("#copy-ark").click(function(){return copyLink(_adp.zcClient)}),checkFileVersion(!1,"js/project.js"),$("#toggle-project-viewport").click(function(){return $(".project-list-page").toggleClass("hidden-xs"),$(".project-search").hasClass("hidden-xs")?$(this).text("Show Project Search"):$(this).text("Show Project List")}),$("#community-map google-map-poly").on("google-map-poly-click",function(a){var b,c;return c=$(this).attr("data-project"),b=uri.urlString+"project.php?id="+c,goTo(b),!1}),$("#community-map").on("google-map-ready",function(){var a,b,c,d,e,f,g,h,i,j,k,l;if(h=p$("#community-map"),null!=_adp.aggregateHulls){for(a=[],c=Object.toArray(_adp.aggregateHulls),d=0,f=c.length;f>d;d++)for(b=c[d],k=Object.toArray(b),e=0,g=k.length;g>e;e++)j=k[e],i=new Point(j.lat,j.lng),a.push(i);console.info("Adjusting zoom from "+h.zoom),l=getMapZoom(a,"#community-map"),console.info("Calculated new zoom "+l),h.zoom=l}return!1})});
//# sourceMappingURL=maps/c.map