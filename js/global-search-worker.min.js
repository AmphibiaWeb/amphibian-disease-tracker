var getSampleSummaryDialog,indexOf=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};importScripts("c.min.js","https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"),self.addEventListener("message",function(a){var b,c;switch(a.data.action){case"summary-dialog":return b=a.data.resultsList,c=a.data.tableToProjectMap,getSampleSummaryDialog(b,c,a.data.windowWidth)}}),getSampleSummaryDialog=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;if(isArray(a)||(a=Object.toArray(a)),0===a.length)return console.warn("There were no results in the result list"),!1;for(console.log("Generating dialog from",a),y=[],u=[],n=0,J=["cartodb_id","the_geom","the_geom_webmercator","id"],h={species:[],diseases:[],data:{}},o=0,q=a.length;o<q;o++){x=a[o],++n,i=.5*c,j=.3*c;try{D=x.rows;try{d={},z=x.rows;for(t in z){for(C=z[t],p=0,r=J.length;p<r;p++)e=J[p],delete C[e];d[t]=C,C.carto_table=x.table,C.project_id=x.project_id,E=getPrettySpecies(C),indexOf.call(h.species,E)<0&&h.species.push(E),f=C.diseasetested,indexOf.call(h.diseases,f)<0&&h.diseases.push(f),isNull(h.data[E])&&(h.data[E]={}),isNull(h.data[E][f])&&(h.data[E][f]={samples:0,positive:0,negative:0,no_confidence:0,prevalence:0}),C.diseasedetected.toBool()?h.data[E][f].positive++:"no_confidence"===C.diseasedetected.toLowerCase()?h.data[E][f].no_confidence++:h.data[E][f].negative++,h.data[E][f].samples++,v=h.data[E][f].positive/h.data[E][f].samples,h.data[E][f].prevalence=v,u.push(C)}D=d}catch(a){A=x.rows;for(t in A)C=A[t],C.carto_table=x.table,C.project_id=x.project_id,u.push(C)}if(g=JSON.stringify(D),isNull(g)){console.warn("Got bad data for row #"+n+"!",x,x.rows,g);continue}g=""+g}catch(a){g="Invalid data from server"}H=w=b[x.table],C='<tr>\n  <td colspan="4" class="code-box-container"><pre readonly class="code-box language-json" style="max-width:'+i+"px;min-width:"+j+'px">'+g+'</pre></td>\n  <td class="text-center"><paper-icon-button data-toggle="tooltip" raised class="click" data-href="https://amphibiandisease.org/project.php?id='+w.id+'" icon="icons:arrow-forward" title="'+w.name+'"></paper-icon-button></td>\n</tr>',y.push(C)}G={},B=h.data;for(E in B){l=B[E];for(k in l)g=l[k],null==G[k]&&(G[k]=[]),v=100*g.prevalence,v=roundNumberSigfig(v,2),G[k].push("<tr>\n  <td>"+E+"</td>\n  <td>"+g.samples+"</td>\n  <td>"+g.positive+"</td>\n  <td>"+g.negative+"</td>\n  <td>"+v+"%</td>\n</tr>")}F="";for(k in G)I=G[k],F+='<div class="row">\n  <div class="col-xs-12">\n    <h3>'+k+'</h3>\n    <table class="table table-striped">\n      <tr>\n        <th>Species</th>\n        <th>Samples</th>\n        <th>Disease Positive</th>\n        <th>Disease Negative</th>\n        <th>Disease Prevalence</th>\n      </tr>\n      '+I.join("\n")+"\n    </table>\n  </div>\n</div>";return m='<paper-dialog id="modal-sql-details-list" modal always-on-top auto-fit-on-attach>\n  <h2>Project Result List</h2>\n  <paper-dialog-scrollable>\n    '+F+'\n    <div class="row">\n      <div class="col-xs-12">\n        <h3>Raw Data</h3>\n        <table class="table table-striped">\n          <tr>\n            <th colspan="4">Query Data</th>\n            <th>Visit Project</th>\n          </tr>\n          '+y.join("\n")+'\n        </table>\n      </div>\n    </div>\n  </paper-dialog-scrollable>\n  <div class="buttons">\n    <paper-button id="generate-download">Create Download</paper-button>\n    <paper-button dialog-dismiss>Close</paper-button>\n  </div>\n</paper-dialog>',s={html:m,outputData:u},self.postMessage(s),self.close()};
//# sourceMappingURL=maps/c.map