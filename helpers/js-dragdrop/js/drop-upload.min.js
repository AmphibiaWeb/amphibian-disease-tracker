(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=[].slice;window.locationData={},locationData.params={enableHighAccuracy:!0},locationData.last=void 0,window.debounce_timer=null,r=function(a,b){var c;if(null==b&&(b=!1),b)return"boolean"==typeof a;try{return"boolean"==typeof a?a===!0||a===!1:"string"==typeof a?"true"===a.toLowerCase()||"false"===a.toLowerCase():"number"==typeof a?1===a||0===a:!1}catch(d){return c=d,!1}},s=function(a){return!a||0===a.length},q=function(a){return!a||/^\s*$/.test(a)},v=function(a){var b;try{if((s(a)||q(a)||null==a)&&a!==!1&&0!==a)return!0}catch(c){return b=c,!1}return!1},u=function(a){var b;if("object"==typeof a)return!0;try{return JSON.parse(a),!0}catch(c){return b=c,!1}return!1},w=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},J=function(a){return!w(a)||v(a)?0:parseFloat(a)},K=function(a){return!w(a)||v(a)?0:parseInt(a)},String.prototype.toBool=function(){return""+this=="true"},Boolean.prototype.toBool=function(){return""+this=="true"},Number.prototype.toBool=function(){return""+this=="1"},String.prototype.addSlashes=function(){return this.replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},Object.size=function(a){var b,c,d;if("object"!=typeof a)try{return a.length}catch(e){b=e,console.error("Passed argument isn't an object and doesn't have a .length parameter"),console.warn(b.message)}d=0;for(c in a)a.hasOwnProperty(c)&&d++;return d},h=function(a,b){return setTimeout(b,a)},H=function(a,b){var c;return null==b&&(b=0),c=Math.pow(10,b),Math.round(a*c)/c},I=function(a,b){var c,d,e,f,g;return null==b&&(b=0),e=""+H(a,b),c=e.split("."),1===c.length?e+"."+Array(b+1).join("0"):(g=c.pop(),f=c[0]+".",g.length===b?e:(d=b-g.length,g+=Array(d+1).join("0"),""+f+g))},x=function(a){var b;return"array"==typeof a&&(a=L(arr)),b=JSON.stringify(a),encodeURIComponent(i(b))},i=function(a){var b;try{return Base64.encode(a)}catch(c){return b=c,console.warn("Bad encode string provided"),a}},f=function(a){var b;try{return Base64.decode(a)}catch(c){return b=c,console.warn("Bad decode string provided"),a}},t=function(a){return $(a+":hover").length>0},jQuery.fn.exists=function(){return jQuery(this).length>0},jQuery.fn.isVisible=function(){return jQuery(this).is(":visible")&&"hidden"!==jQuery(this).css("visibility")},jQuery.fn.hasChildren=function(){return Object.size(jQuery(this).children())>3},d=function(a){return function(a){return encodeURI(a).split(/%..|./).length-1}}(this),L=function(a){var b,c,d;d={};for(c in a)b=a[c],void 0!==b&&(d[c]=b);return d},z=function(a,b,c){var d,e,f,g;if(null==b&&(b={}),null==c&&(c=!0),$("script[src='"+a+"']").exists()){if("function"==typeof b)try{b()}catch(h){d=h,console.error("Script is already loaded, but there was an error executing the callback function - "+d.message)}return!0}return g=document.createElement("script"),g.setAttribute("src",a),g.setAttribute("async","async"),g.setAttribute("type","text/javascript"),g.src=a,g.async=!0,f=function(){var a;a=g.readyState;try{if(!b.done&&(!a||/loaded|complete/.test(a))&&(b.done=!0,"function"==typeof b))try{return b()}catch(c){return d=c,console.error("Postload callback error - "+d.message)}}catch(c){return d=c,console.error("Onload error - "+d.message)}},e=function(){console.warn("There may have been a problem loading "+a);try{if(!b.done&&(b.done=!0,"function"==typeof b&&c))try{return b()}catch(e){return d=e,console.error("Post error callback error - "+d.message)}}catch(e){return d=e,console.error("There was an error in the error handler! "+d.message)}},g.setAttribute("onload",f),g.setAttribute("onreadystate",f),g.setAttribute("onerror",e),g.onload=g.onreadystate=f,g.onerror=e,document.getElementsByTagName("head")[0].appendChild(g),!0},window.loadJS=z,String.prototype.toTitleCase=function(){var a,b,c,d,e,f,g,h,i,j,k;for(h=this.replace(/([^\W_]+[^\s-]*) */g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}),g=["A","An","The","And","But","Or","For","Nor","As","At","By","For","From","In","Into","Near","Of","On","Onto","To","With"],a=0,c=g.length;c>a;a++)e=g[a],f=RegExp("\\s"+e+"\\s","g"),h=h.replace(f,function(a){return a.toLowerCase()});for(k=["Id","Tv"],b=0,d=k.length;d>b;b++)i=k[b],j=RegExp("\\b"+i+"\\b","g"),h=h.replace(j,i.toUpperCase());return h},Function.prototype.debounce=function(){var a,b,c,d,e,f,g;if(f=arguments[0],d=arguments[1],g=arguments[2],a=4<=arguments.length?N.call(arguments,3):[],null==f&&(f=300),null==d&&(d=!1),null==g&&(g=debounce_timer),e=this,b=function(){return d||e.apply(e,a),console.log("Debounce applied")},null!=g)try{clearTimeout(g)}catch(h){c=h}else d&&(e.apply(obj,a),console.log("Executed immediately"));return setTimeout(b,f)},G=function(a,b){var c,d,e;return null==a&&(a=0),null==b&&(b=1),e=Math.random(),null==a&&(c=[0,a],a=c[0],b=c[1]),a>b&&(d=[b,a],a=d[0],b=d[1]),Math.floor(e*(b-a+1)+a)},M=function(a,b,c,d){var e,f;return null==b&&(b="warning"),null==c&&(c="body"),null==d&&(d="#js-uploader-status-message"),$(d).exists()||(e='<div class="alert alert-'+b+' alert-dismissable" role="alert" id="'+d.slice(1)+'">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n    <div class="alert-message"></div>\n</div>',f=$("main").exists()?"main":$("article").exists()?"article":c,$(f).prepend(e)),$(d+" .alert-message").html(a)},null==window.dropperParams&&(window.dropperParams={}),dropperParams.toastStatusMessage=M,B=function(a){return null==a?!1:(window.open(a),!1)},C=function(a){return B(a)},o=function(a){return null==a?!1:(window.location.href=a,!1)},A=function(a){return null==a&&(a=!0),$(".newwindow").each(function(){var b,c;return b=$(this).attr("href"),null==b&&(b=$(this).attr("data-href")),c=function(a){return null==a?!1:(window.open(a),!1)},$(this).click(function(d){return a&&(d.preventDefault(),d.stopPropagation()),c(b)}),$(this).keypress(function(){return c(b)})})},dropperParams.mapNewWindows=A,g=function(a){var b;try{if(!$("html /deep/ "+a).exists())throw"Bad /deep/ selector";return $("html /deep/ "+a)}catch(c){b=c;try{if(!$("html >>> "+a).exists())throw"Bad >>> selector";return $("html >>> "+a)}catch(c){return b=c,$(a)}}},e=function(a){return g(a)},c=function(a){return null==a&&(a=".click"),$(a).each(function(){var a,b,c;try{if(c=$(this).attr("data-href"),!v(c)){$(this).unbind();try{c===uri.o.attr("path")&&"paper-tab"===$(this).prop("tagName").toLowerCase()&&$(this).parent().prop("selected",$(this).index())}catch(d){b=d,console.warn("tagname lower case error")}return $(this).click(function(){return $(this).attr("newTab").toBool()||$(this).attr("newtab").toBool()?C(c):o(c)}),c}if(a=$(this).attr("data-function"),null!=a)return $(this).unbind(),$(this).click(function(){try{return console.log("Executing bound function "+a+"()"),window[a]()}catch(c){return b=c,console.error("'"+a+"()' is a bad function - "+b.message)}})}catch(d){return b=d,console.error("There was a problem binding to #"+$(this).attr("id")+" - "+b.message)}}),!1},n=function(a){var b,c,d;try{return d=a.split("."),b=d.pop(),d.push("png"),d.join(".")}catch(e){return c=e,""}},y=function(c,d){var f,g;return null==c&&(c=".lightboximage"),null==d&&(d=!1),g={onStart:function(){return E()},onEnd:function(){return D(),a()},onLoadStart:function(){return b()},onLoadEnd:function(){return a()},allowedTypes:"png|jpg|jpeg|gif|bmp|webp",quitOnDocClick:!0,quitOnImgClick:!0},f=d?e(c):$(c),f.click(function(a){try{return $(this).imageLightbox(g).startImageLightbox(),a.preventDefault(),a.stopPropagation(),console.warn("Event propagation was stopped when clicking on this.")}catch(b){return a=b,console.error("Unable to lightbox this image!")}}).each(function(){var a,b,d;console.log("Using selectors '"+c+"' / '"+this+"' for lightboximages");try{if("img"===$(this).prop("tagName").toLowerCase()&&"a"!==$(this).parent().prop("tagName").toLowerCase())return d=$(this).removeClass("lightboximage").prop("outerHTML"),b=function(){switch(!1){case!!v($(this).attr("data-layzr-retina")):return $(this).attr("data-layzr-retina");case!!v($(this).attr("data-layzr")):return $(this).attr("data-layzr");default:return $(this).attr("src")}}.call(this),$(this).replaceWith("<a href='"+b+"' class='lightboximage'>"+d+"</a>")}catch(e){return a=e,console.log("Couldn't parse through the elements")}})},b=function(){return $('<div id="imagelightbox-loading"><div></div></div>').appendTo("body")},a=function(){return $("#imagelightbox-loading").remove(),$("#imagelightbox-overlay").click(function(){return $("#imagelightbox").click()})},E=function(){return $('<div id="imagelightbox-overlay"></div>').appendTo("body")},D=function(){return $("#imagelightbox-overlay").remove()},k=function(a){return null==a&&(a=".sciname"),$(".sciname").each(function(){var a;return a="italic"===$(this).css("font-style")?"normal":"italic",$(this).css("font-style",a)})},F=function(a){return a=encodeURIComponent(a),a.replace(/%20/g,"+")},window.locationData={},locationData.params={enableHighAccuracy:!0},locationData.last=void 0,l=function(a){var b,c;return null==a&&(a=void 0),c=function(a,b){return window.locationData.lat=a.coords.latitude,window.locationData.lng=a.coords.longitude,window.locationData.acc=a.coords.accuracy,window.locationData.last=Date.now(),null!=b&&b(window.locationData),!1},b=function(a,b){var c;return c=function(){switch(a.code){case 0:return"There was an error while retrieving your location: "+a.message;case 1:return"The user prevented this page from retrieving a location";case 2:return"The browser was unable to determine your location: "+a.message;case 3:return"The browser timed out retrieving your location."}}(),console.error(c),null!=b&&b(!1),!1},navigator.geolocation?navigator.geolocation.getCurrentPosition(c,b,window.locationData.params):(console.warn("This browser doesn't support geolocation!"),null!=a?a(!1):void 0)},m=function(){var a;return a=function(){return $.map($("body *"),function(a,b){return"static"!==$(a).css("position")?parseInt($(a).css("z-index")||1):void 0})},Math.max.apply(null,a())},j=function(){return M("Sorry, this feature is not yet finished"),stopLoad(),!1},$(function(){return c(),window.bindClicks=c,window.mapNewWindows=A}),null==window.dropperParams&&(window.dropperParams={}),null==dropperParams.metaPath&&(dropperParams.metaPath=""),null==dropperParams.uploadPath&&(dropperParams.uploadPath="uploaded_images/"),null==dropperParams.dependencyPath&&(dropperParams.dependencyPath="bower_components/"),null==dropperParams.thumbWidth&&(dropperParams.thumbWidth=640),null==dropperParams.thumbHeight&&(dropperParams.thumbHeight=480),null==dropperParams.showProgress&&(dropperParams.showProgress=!0),null==dropperParams.clickTargets&&(dropperParams.clickTargets=!1),null==dropperParams.mimeTypes&&(dropperParams.mimeTypes="image/*,video/mp4,video/3gpp,audio/*"),p=function(a,b){return null==a&&(a="#upload-image"),dropperParams.dropzonePath=dropperParams.metaPath+"js/dropzone-custom.min.js",dropperParams.bootstrapPath=dropperParams.dependencyPath+"bootstrap/dist/js/bootstrap.min.js","function"!=typeof b&&(b=function(a,b){var c;if("object"!=typeof b)return console.error("Dropzone returned an error - "+b),dropperParams.toastStatusMessage("<strong>Error</strong> There was a problem with the server handling your image. Please try again.","danger","main"),!1;if(b.status!==!0)return null==b.human_error&&(b.human_error="There was a problem uploading your image."),dropperParams.toastStatusMessage("<strong>Error</strong> "+b.human_error,"danger","main"),console.error("Error uploading!",b),!1;try{console.info("Server returned the following result:",b),console.info("The script returned the following file information:",a),dropperParams.dropzone.removeAllFiles(),dropperParams.toastStatusMessage("Upload complete","success","main")}catch(d){c=d,console.error("There was a problem with upload post-processing - "+c.message),console.warn("Using",fileName,b),dropperParams.toastStatusMessage("<strong>Error</strong> Your upload completed, but we couldn't post-process it.","danger","main")}return!1}),z(dropperParams.bootstrapPath),z(dropperParams.dropzonePath,function(){var c,d,f,g,h,i,j,k;c=document.createElement("link"),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",dropperParams.metaPath+"css/main.min.css"),document.getElementsByTagName("head")[0].appendChild(c),Dropzone.autoDiscover=!1,f=null!=(k=dropperParams.uploadText)?k:"Drop your file here to upload",g=function(){return e(a).css("box-shadow","").css("border",""),e(a+" .dz-message span").text(f)},d=function(b){e(a+" + .image-upload-progress").remove(),e("#do-upload-image").css("top","").css("position","");try{return b.removeAllFiles()}catch(c){}},h={url:dropperParams.metaPath+"meta.php?do=upload_file&uploadpath="+dropperParams.uploadPath+"&thumb_width="+dropperParams.thumbWidth+"&thumb_height="+dropperParams.thumbHeight,acceptedFiles:dropperParams.mimeTypes,autoProcessQueue:!0,maxFiles:1,dictDefaultMessage:f,clickable:dropperParams.clickTargets,init:function(){return this.on("error",function(a){return function(b,c){return dropperParams.toastStatusMessage("An error occured sending your image to the server - "+c,"danger","main"),console.error("Got the following file details back:",b),d(a)}}(this)),this.on("canceled",function(a){return function(){return dropperParams.toastStatusMessage("Upload canceled.","info","main"),d(a)}}(this)),this.on("dragover",function(){return e(a+" .dz-message span").text(f),e(a).css("box-shadow","0px 0px 15px rgba(15,157,88,.8)").css("border","1px solid #0F9D58")}),this.on("dragleave",function(){return g()}),this.on("dragend",function(){return g()}),this.on("drop",function(){return g()}),this.on("uploadprogress",function(b,c,d){var f,g,h;return dropperParams.showProgress===!0?(h=e(a+" + .image-upload-progress"),h.exists()||(g='<div class="image-upload-progress">\n  <div class="progress">\n    <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="min-width:2em;">\n      <span class="upload-percent">0</span>%<span class="sr-only"> Complete</span>\n    </div>\n  </div>\n  <p class="text-center text-muted"><span class="bytes-done">0</span>/<span class="bytes-total">0</span> bytes</p>\n</div>',e(a).after(g),h=e(a+" + .image-upload-progress"),f=$(".image-upload-progress").outerHeight()+$("#profile_new_message").height()+$("#do-upload-image").outerHeight(),$("#do-upload-image").css("top","-"+f+"px!important").css("position","relative!important")),c=K(c),h.find(".progress-bar").attr("aria-valuenow",c).css("width",c+"%"),h.find(".upload-percent").text(c),h.find(".bytes-done").text(d),h.find(".bytes-total").text(b.size)):void 0}),this.on("success",function(a){return function(c,e){return d(a),b(c,e)}}(this))}},e(a).hasClass("dropzone")||e(a).addClass("dropzone");try{j=new Dropzone(e(a).get(0),h)}catch(l){i=l,console.warn("Warning! The drop target may be misconfigured. Dropzone said '"+i.message+"'"),dropperParams.config=h,console.info("Your dropzone configuration has been saved in dropperParams.config")}return dropperParams.dropzone=j}),!1},dropperParams.handleDragDropImage=p}).call(this);
//# sourceMappingURL=maps/drop-upload.map